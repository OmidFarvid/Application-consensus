{% extends 'base.html' %}
{% load  custom_tags %}
{% block content %}


    <div class="page-wrapper" style="display: block;">
        <div class="page-breadcrumb">
                <div class="col-5 align-self-center">
                    <h4 class="page-title">School applications</h4>
                </div>
        </div>

        <div class="container-fluid">
            <div class="row">
                <div class="col col-md-12">
                    <div class="card">
                        <div class="card-body">
                            <form method="post">{% csrf_token %}
                                {{ forms.search }}
                                <input class="btn btn-dark" type="submit" value="Search application" style="width: 20%; margin-top: 10px">
                            </form>

                            <form id="status_form" method="post">{% csrf_token %}
                                {{ forms.status }}
                            </form>

                            <div class="table-responsive">
                            <table class="table table-striped table-bordered">
                                 <thead>
                                      <tr>
                                        <th>Application id</th>
                                        <th>Student first name</th>
                                        <th>Student last name</th>
{#                                        <th>Student gender</th>#}
                                        <th>Student email</th>
                                        <th>Student phone_number</th>
                                        <th>Application score</th>
                                        <th>Status</th>
                                        <th></th>
                                      </tr>
                                    </thead>
                                    <tbody>

                                    {% for application in applications %}
                                            <tr>
                                                <td>{{ application.id }}</td>
                                                <td>{{ application.student.first_name }}</td>
                                                <td>{{ application.student.last_name }}</td>
{#                                                <td>{{ application.student.gender }}</td>#}
                                                <td>{{ application.student.email }}</td>
                                                <td>{{ application.student.phone_number }}</td>
                                                <td>{{ application.application_score }}</td>
                                                <td>{{ application.status }}</td>
                                                {% if application|offer_status == 'Pending' %}
                                                    <td style="text-align: center">
                                                        <button class="btn-primary status-application" data-id="{{ application.id }}" data-status="Accepted">Accepted</button>
                                                        <button class="btn-danger status-application" data-id="{{ application.id }}" data-status="Rejected">Rejected</button>
                                                    </td>
                                                {% elif application|offer_status is not None %}
                                                        <td> {{application|offer_status}} </td>
                                                {% else %}
                                                <td style="text-align: center">No offer</td>
                                                {% endif %}
                                            </tr>
                                        {% endfor %}


                                    </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>




{#    <div class="container">#}
{#	<div class="row">#}
{#		<h2>School applications</h2>#}
{##}
{#    <form method="post">{% csrf_token %}#}
{#        {{ forms.search }}#}
{#        <input class="btn btn-primary" type="submit" value="Search application" style="width: 20%; margin-top: 10px">#}
{#    </form>#}
{##}
{#    <form id="status_form" method="post">{% csrf_token %}#}
{#        {{ forms.status }}#}
{#    </form>#}
{##}
{#<table class="table table-bordered">#}
{#    <thead>#}
{#      <tr>#}
{#        <th>Application id</th>#}
{#        <th>Student first name</th>#}
{#        <th>Student last name</th>#}
{#        <th>Student gender</th>#}
{#        <th>Student email</th>#}
{#        <th>Student phone_number</th>#}
{#        <th>Application score</th>#}
{#        <th></th>#}
{#      </tr>#}
{#    </thead>#}
{#    <tbody>#}
{##}
{#    {% for application in applications %}#}
{#            <tr>#}
{#                <td>{{ application.id }}</td>#}
{#                <td>{{ application.student.first_name }}</td>#}
{#                <td>{{ application.student.last_name }}</td>#}
{#                <td>{{ application.student.gender }}</td>#}
{#                <td>{{ application.student.email }}</td>#}
{#                <td>{{ application.student.phone_number }}</td>#}
{#                <td>{{ application.application_score }}</td>#}
{#                {% if application|offer_status == 'Pending' %}#}
{#                    <td>#}
{#                        <button class="btn-primary status-application" data-id="{{ application.id }}" data-status="Accepted">Accepted</button>#}
{#                        <button class="btn-primary status-application" data-id="{{ application.id }}" data-status="Rejected">Rejected</button>#}
{#                    </td>#}
{#                {% elif application|offer_status is not None %}#}
{#                        <td> {{application|offer_status}} </td>#}
{#                {% else %}#}
{#                <td>No offer</td>#}
{#                {% endif %}#}
{#            </tr>#}
{#        {% endfor %}#}
{##}
{##}
{#    </tbody>#}
{#  </table>#}
{#	</div>#}
{#    </div>#}

        <script>
            $('.status-application').on('click', function () {
                $('#id_id').val($(this).attr('data-id'));
                $('#id_status').val($(this).attr('data-status'));
                $('#status_form').submit()
            })
        </script>

{% endblock content %}